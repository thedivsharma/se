<!DOCTYPE html>
<html lang="en" class="dark">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Order History - Woodman's World</title>
	<script>
		if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
			document.documentElement.classList.add('dark'); document.documentElement.classList.remove('light');
		} else { document.documentElement.classList.remove('dark'); document.documentElement.classList.add('light'); }
	</script>
	<script src="https://cdn.tailwindcss.com"></script>
	<style>
		body { font-family: 'Inter', sans-serif; }
		#app { background-color: #fafaf9; transition: background-color .3s; }
		.dark #app { background-color: #171717; }
		.icon-btn { transition: transform .2s, color .2s; }
		.icon-btn:hover { transform: scale(1.05); color: #d97706; }
	</style>
</head>
<body id="app">
	<!-- Header -->
	<header class="sticky top-0 z-50 bg-white dark:bg-neutral-800 shadow-md">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="flex items-center justify-between h-16">
				<a href="HomePage.html" class="text-2xl font-bold text-stone-800 dark:text-stone-50 flex items-center">
					<span class="hidden sm:inline">Woodman's World</span>
					<span class="sm:hidden">Woodman's</span>
				</a>
				<div class="flex items-center space-x-4">
					<button onclick="toggleTheme()" class="p-2 text-stone-600 dark:text-stone-300 hover:text-amber-600 dark:hover:text-amber-400 icon-btn rounded-full">
						<svg id="theme-toggle-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"></svg>
					</button>
					<a href="LoginRegister.html" class="hidden md:flex items-center text-stone-600 dark:text-stone-300 hover:text-amber-600 dark:hover:text-amber-400 icon-btn">
						<svg class="w-6 h-6 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
						<span class="text-sm font-medium">Account / Login</span>
					</a>
					<a href="ShoppingCart.html" class="relative p-2 text-stone-600 dark:text-stone-300 hover:text-amber-600 dark:hover:text-amber-400 icon-btn rounded-full">
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
						<span class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full">4</span>
					</a>
				</div>
			</div>
		</div>
	</header>

	<main class="max-w-7xl mx-auto py-8 sm:px-6 lg:px-8">
		<h1 class="text-3xl font-extrabold text-stone-800 dark:text-stone-100 mb-6">Order History</h1>

		<div class="bg-white dark:bg-neutral-800 rounded-xl shadow-lg overflow-hidden">
			<div class="overflow-x-auto">
				<table class="min-w-full divide-y divide-stone-200 dark:divide-neutral-700">
					<thead class="bg-stone-100 dark:bg-neutral-900">
						<tr>
							<th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Order ID</th>
							<th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Date</th>
							<th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Items</th>
							<th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Total</th>
							<th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Status</th>
							<th class="px-4 py-3"></th>
						</tr>
					</thead>
					<tbody id="orders-tbody" class="divide-y divide-stone-100 dark:divide-neutral-700 text-sm">
						<!-- filled by JS -->
					</tbody>
				</table>
			</div>
		</div>
	</main>

	<!-- Tracking Modal -->
	<div id="tracking-modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4">
		<div class="bg-white dark:bg-neutral-800 rounded-xl shadow-xl max-w-xl w-full">
			<div class="flex items-center justify-between px-5 py-4 border-b border-stone-200 dark:border-neutral-700">
				<h3 class="text-lg font-semibold text-stone-800 dark:text-stone-100">Order Tracking</h3>
				<button onclick="closeTracking()" class="text-stone-500 hover:text-stone-800 dark:text-stone-400 dark:hover:text-stone-200">✕</button>
			</div>
			<div class="p-5 space-y-4">
				<div>
					<p class="text-sm text-stone-500 dark:text-stone-400">Order</p>
					<p id="track-order-id" class="font-semibold text-stone-800 dark:text-stone-100">#</p>
				</div>

				<!-- Timeline -->
				<ol id="timeline" class="relative border-l border-stone-200 dark:border-neutral-700 pl-4 space-y-6">
					<!-- steps injected -->
				</ol>

				<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
					<div class="text-sm">
						<p class="text-stone-500 dark:text-stone-400">Carrier</p>
						<p id="track-carrier" class="font-medium">—</p>
					</div>
					<div class="text-sm">
						<p class="text-stone-500 dark:text-stone-400">Tracking No.</p>
						<p id="track-number" class="font-medium">—</p>
					</div>
				</div>

				<div class="pt-2">
					<a id="invoice-link" href="Invoice.html" class="inline-flex items-center px-4 py-2 rounded-lg bg-amber-600 text-white font-semibold hover:bg-amber-700">View Invoice</a>
				</div>
			</div>
		</div>
	</div>

	<footer class="bg-neutral-800 dark:bg-neutral-900 mt-12 py-8">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-stone-300 text-center text-sm">
			<p>&copy; 2025 Woodman's World. All rights reserved.</p>
		</div>
	</footer>

	<script>
		// Theme toggle
		window.toggleTheme = function() {
			const html = document.documentElement;
			if (html.classList.contains('dark')) { html.classList.remove('dark'); html.classList.add('light'); localStorage.theme='light'; }
			else { html.classList.add('dark'); html.classList.remove('light'); localStorage.theme='dark'; }
			updateThemeIcon();
		}
		window.updateThemeIcon = function() {
			const ic = document.getElementById('theme-toggle-icon');
			const isDark = document.documentElement.classList.contains('dark');
			if (ic) ic.innerHTML = isDark
				? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>'
				: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>';
		}

		// Mock orders
		const ORDERS = [
			{ id: 'WW-2025-1015', date: '2025-10-12', items: 'Walnut Bowl, Mug Set', total: 95.49, status: 'Shipped', carrier: 'UPS', tracking: '1Z999AA10123456784' },
			{ id: 'WW-2025-1014', date: '2025-10-05', items: 'Leaf Earrings', total: 45.00, status: 'Delivered', carrier: 'USPS', tracking: '9400 1000 0000 0000 0000 00' },
			{ id: 'WW-2025-1013', date: '2025-09-28', items: 'Oak Cutting Board', total: 75.00, status: 'Confirmed', carrier: 'FedEx', tracking: '449044304137821' },
		];
		const STEPS = ['Confirmed', 'Shipped', 'Delivered'];

		function renderOrders() {
			const tbody = document.getElementById('orders-tbody');
			tbody.innerHTML = ORDERS.map(o => `
				<tr class="bg-white dark:bg-neutral-800">
					<td class="px-4 py-3 font-semibold text-amber-700 dark:text-amber-500">#${o.id}</td>
					<td class="px-4 py-3">${o.date}</td>
					<td class="px-4 py-3">${o.items}</td>
					<td class="px-4 py-3">$${o.total.toFixed(2)}</td>
					<td class="px-4 py-3">
						<span class="px-2 py-1 rounded-full text-xs font-semibold ${badgeClass(o.status)}">${o.status}</span>
					</td>
					<td class="px-4 py-3 text-right space-x-2">
						<button onclick="openTracking('${o.id}')" class="text-amber-600 hover:text-amber-800 dark:text-amber-400 dark:hover:text-amber-200">Track</button>
						<a href="Invoice.html?orderId=${encodeURIComponent(o.id)}" class="text-stone-600 hover:text-amber-600 dark:text-stone-300 dark:hover:text-amber-200">Invoice</a>
					</td>
				</tr>
			`).join('');
		}

		function badgeClass(status) {
			if (status === 'Confirmed') return 'bg-yellow-100 text-yellow-800';
			if (status === 'Shipped') return 'bg-blue-100 text-blue-800';
			return 'bg-green-100 text-green-800';
		}

		function openTracking(orderId) {
			const order = ORDERS.find(o => o.id === orderId);
			if (!order) return;
			document.getElementById('track-order-id').textContent = `#${order.id}`;
			document.getElementById('track-carrier').textContent = order.carrier;
			document.getElementById('track-number').textContent = order.tracking;
			document.getElementById('invoice-link').href = `Invoice.html?orderId=${encodeURIComponent(order.id)}`;
			// timeline
			const currentIndex = STEPS.indexOf(order.status);
			const timeline = document.getElementById('timeline');
			timeline.innerHTML = STEPS.map((step, idx) => {
				const reached = idx <= currentIndex;
				return `
					<li class="ml-2">
						<div class="absolute -left-1.5 w-3 h-3 rounded-full ${reached ? 'bg-amber-600' : 'bg-stone-300 dark:bg-neutral-600'}"></div>
						<p class="text-sm ${reached ? 'text-stone-800 dark:text-stone-100 font-medium' : 'text-stone-500 dark:text-stone-400'}">${step}</p>
						${idx < STEPS.length - 1 ? '<div class="h-5"></div>' : ''}
					</li>
				`;
			}).join('');
			document.getElementById('tracking-modal').classList.remove('hidden');
			document.getElementById('tracking-modal').classList.add('flex');
		}
		function closeTracking() {
			document.getElementById('tracking-modal').classList.add('hidden');
			document.getElementById('tracking-modal').classList.remove('flex');
		}

		document.addEventListener('DOMContentLoaded', () => {
			updateThemeIcon();
			renderOrders();
		});
	</script>
</body>
</html>
